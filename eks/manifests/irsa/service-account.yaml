# =============================================================================
# ServiceAccount with IRSA
# =============================================================================
# Kubernetes ServiceAccount annotated with IAM role ARN
#
# When a Pod uses this ServiceAccount, it automatically receives
# temporary AWS credentials for the associated IAM role.
#
# Setup:
# 1. Run terraform apply to create IAM role
# 2. Get role ARN: terraform output -raw irsa_s3_role_arn
# 3. Update the annotation below with the actual ARN
# 4. Apply this manifest

apiVersion: v1
kind: ServiceAccount
metadata:
  name: s3-readonly-sa
  namespace: default
  annotations:
    # IMPORTANT: Replace with actual IAM role ARN from terraform output
    # Get ARN: terraform -chdir=eks output -raw irsa_s3_role_arn
    eks.amazonaws.com/role-arn: arn:aws:iam::ACCOUNT_ID:role/PROJECT_NAME-pod-s3-readonly-role
  labels:
    app: irsa-demo
